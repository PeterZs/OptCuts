% !TeX root = OptCuts.tex

\section{Joint Discrete-Continuous Search}

\subsection{UV Topology Space}

The UV topology space we are searching in can be represented using a directed graph $G_T$ with its vertices $v_T \in V_T$ being all possible UV topologies of a given 3D surface, and its edges $e_T \in E_T$ are the basic topological operations conducted on the UV map that can transform one UV topology to a nearby topology. Currently we support boundary and interior vertex split, and corner vertex merge operation.

We define the value $f_v$ of vertex $v_{T,i}$ as 
\[ f_v(v_{T,i}) = \min_{U} E_w(T_i, U) = E_s(T_i) + \min_{U} E_d(T_i, U) \]
and the weights $f_e$ of edge $e_{T,m}$ from $v_{T,i}$ to $v_{T,j}$ as 
\[ f_e(e_{T,m}) = f_v(v_{T,j}) - f_v(v_{T,i}) \]
Thus our problem could be restated as to search for a $v_{T,i}$ in $G_T$ where all edges started from it satisfies $f_e \geq 0$.

\minchen{However, computing $f_v$ for one UV topology requires a whole continuous optimization process, and even the number of neighbors of one UV topology is in the scale of $n_v$. Consequently, we construct a single search path on $G_T$ by iteratively finding a search direction and decide the step size via a forward line search. progressively introducing or removing seams on the UV map, and we only estimate $f_e$ on a local stencil of $U$ for a filtered set of neighbors on $G_T$ so that the whole process of continuous optimization is only conducted while necessary.}

\minchen{
We minimize $E_w$ by iteratively alternate between continuous optimization (in descent steps) and discrete optimization (in topology steps):
\begin{itemize}
\item In descent steps, we compute $\min_{U_i} E_{SD}$ given $v_{T,i}$ via projected Newton method~\cite{Teran2005Robust} so that we obtain
\[ f_v(v_{T,i}) = E_{se,i} + \min_{U_i} E_{SD} \]
\item In topology steps, we estimate $f_v(v_{T,j})$ for a filtered set of neighbors of $v_{T,i}$ on a local stencil of $U$ as $\hat{f}_v$ and move onto the neighbor $v_{T,i+1}$ with smallest $\hat{f}_v$.
\end{itemize}
If after a descent step, $f_v(v_{T,i}) \geq f_v(v_{T,i-1})$ is detected, we stop the process by rolling back to $v_{T,i-1}$, which is the stationary of $E_w$ w.r.t. both UV topology (in an approximation sense) and coordinates that we are searching for.
}

\subsection{Energy Definition}

To start with, we use symmetric Dirichlet energy~\cite{Smith2015Bijective} as our distortion energy, normalized by surface area:
\[ E_d = E_{SD} = \frac{1}{\sum_{t\in\mathcal{F}} |A_t|} \sum_{t\in\mathcal{F}} |A_t|(\sigma_{t,1}^2 + \sigma_{t,2}^2 + \sigma_{t,1}^{-2} + \sigma_{t,2}^{-2}) \]
where $\mathcal{F}$ is the set of all triangles, $|A_t|$ is the area of triangle $t$ on the input surface, and $\sigma_{t,i}$ is the $i$-th singular value of the deformation gradient of triangle $t$.

For seam energy, we simply use a normalized seam length:
\[ E_s = E_{SL} = \frac{1}{\sqrt{(\sum_{t\in\mathcal{F}} |A_t|)/\pi}} \sum_{i \in \mathcal{S}} |e_i| \]
where $\mathcal{S}$ is the set of all seam edges on the input surface, $|e_i|$ is the original length of edge $i$.

With the energies normalized, our $E_w$ is invariant of coordinate scale and resolution for meshes with the same shape.



\input{descentSteps}

\input{topologySteps}

\subsection{Convergence}
\label{sec:convergence}

As our method is defined to guarantee convergence, we now analyze the convergence rate. First, it's easy to see that $E_w$ is monotonically decreasing looking at each end of descent steps. Now we look at descent step $i$ and $i+1$, from $E^i_w \geq E^{i+1}_w$ we have
\[ E^i_{SD} - E^{i+1}_{SD} \geq \frac{\lambda}{1-\lambda} (E^{i+1}_{se} - E^i_{se}) \geq \frac{\lambda}{1-\lambda} \frac{1}{\sqrt{(\sum_t |A_t|)/\pi}} |e|_{min} \]
if we now only consider splitting operations that keep increasing $E_{se}$. It's obvious that $E_{SD}$'s theoretical lower bound is defined to be $4$, so we have
\[ n_{alter} \leq \frac{(1-\lambda)\sqrt{(\sum_t |A_t|)/\pi}}{\lambda|e|_{min}} (E^0_{SD} - 4) \]
The most important hint we can read from this is, to accelerate convergence, we can move through multiple vertices on $G_T$ in each topology step to increase $E^{i+1}_{se} - E^i_{se}$.

\minchen{[TODO] update the proof with merge operations?}